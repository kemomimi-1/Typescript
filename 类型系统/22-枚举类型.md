# TypeScript 枚举类型

## 概述
枚举（Enum）是 TypeScript 特有的特性，用于定义一组命名常量。枚举提供了一种组织相关值的方式，使代码更可读和可维护。

## 基本语法

### 数字枚举
```typescript
// 基本的数字枚举
enum Direction {
  Up,      // 0
  Down,    // 1  
  Left,    // 2
  Right     // 3
}

// 使用枚举
let move: Direction = Direction.Up;
console.log(move); // 0
console.log(Direction[0]); // "Up"
```

### 自定义初始值
```typescript
// 自定义初始值
enum StatusCode {
  Success = 200,
  BadRequest = 400,
  NotFound = 404,
  ServerError = 500
}

console.log(StatusCode.Success); // 200
console.log(StatusCode[400]); // "BadRequest"
```

### 字符串枚举
```typescript
// 字符串枚举
enum LogLevel {
  Error = "ERROR",
  Warn = "WARN", 
  Info = "INFO",
  Debug = "DEBUG"
}

console.log(LogLevel.Error); // "ERROR"
// console.log(LogLevel["ERROR"]); // 错误：字符串枚举没有反向映射
```

### 混合枚举
```typescript
// 混合枚举（不推荐）
enum MixedEnum {
  No = 0,
  Yes = "YES"
}

console.log(MixedEnum.No); // 0
console.log(MixedEnum.Yes); // "YES"
```

## 枚举特性

### 反向映射
```typescript
// 数字枚举有反向映射
enum NumberEnum {
  First,
  Second
}

console.log(NumberEnum.First); // 0
console.log(NumberEnum[0]); // "First"
console.log(NumberEnum[NumberEnum.First]); // "First"

// 字符串枚举没有反向映射
enum StringEnum {
  Value = "VALUE"
}

console.log(StringEnum.Value); // "VALUE"
// console.log(StringEnum["VALUE"]); // 错误
```

### 计算成员
```typescript
// 计算枚举成员
enum FileAccess {
  Read = 1 << 1,    // 2
  Write = 1 << 2,   // 4
  ReadWrite = Read | Write // 6
}

console.log(FileAccess.ReadWrite); // 6
```

### 常量成员
```typescript
// 常量枚举成员
const enum ConstDirection {
  Up,
  Down,
  Left,
  Right
}

// 编译时会被内联
let direction = ConstDirection.Up; // 编译为 let direction = 0;
```

## 枚举使用场景

### 状态管理
```typescript
// 使用枚举管理状态
enum DownloadStatus {
  Pending,
  Downloading,
  Completed,
  Failed
}

class Downloader {
  private status: DownloadStatus = DownloadStatus.Pending;
  
  start() {
    this.status = DownloadStatus.Downloading;
  }
  
  complete() {
    this.status = DownloadStatus.Completed;
  }
  
  getStatus(): string {
    return DownloadStatus[this.status];
  }
}
```

### 配置选项
```typescript
// 使用枚举定义配置选项
enum Theme {
  Light = "light",
  Dark = "dark",
  System = "system"
}

enum Language {
  English = "en",
  Chinese = "zh",
  Japanese = "ja"
}

interface AppConfig {
  theme: Theme;
  language: Language;
  notifications: boolean;
}

const config: AppConfig = {
  theme: Theme.Dark,
  language: Language.Chinese,
  notifications: true
};
```

### 错误代码
```typescript
// 使用枚举定义错误代码
enum ErrorCode {
  InvalidInput = 1001,
  ResourceNotFound = 1002,
  PermissionDenied = 1003,
  NetworkError = 2001,
  Timeout = 2002
}

function handleError(code: ErrorCode): string {
  switch (code) {
    case ErrorCode.InvalidInput:
      return "请输入有效的数据";
    case ErrorCode.ResourceNotFound:
      return "资源未找到";
    default:
      return "未知错误";
  }
}
```

## 枚举最佳实践

### 1. 优先使用字符串枚举
```typescript
// 好的实践：使用字符串枚举
enum UserRole {
  Admin = "admin",
  User = "user",
  Guest = "guest"
}

// 更容易调试和序列化
console.log(UserRole.Admin); // "admin"
```

### 2. 使用常量枚举优化性能
```typescript
// 使用常量枚举减少运行时开销
const enum HttpMethod {
  Get = "GET",
  Post = "POST", 
  Put = "PUT",
  Delete = "DELETE"
}

// 编译时内联
const method = HttpMethod.Get; // 编译为 const method = "GET";
```

### 3. 为枚举添加文档
```typescript
/**
 * 用户权限级别
 * @value admin - 管理员权限
 * @value user - 普通用户权限  
 * @value guest - 访客权限
 */
enum PermissionLevel {
  Admin = 100,
  User = 10,
  Guest = 1
}
```

### 4. 避免混合枚举
```typescript
// 避免：混合数字和字符串枚举
enum BadEnum {
  A = 1,
  B = "B"
}

// 好的实践：保持一致性
enum GoodEnum {
  A = "A",
  B = "B"
}
```

## 枚举与联合类型

### 枚举 vs 字面量联合类型
```typescript
// 使用枚举
enum ColorEnum {
  Red = "red",
  Green = "green",
  Blue = "blue"
}

// 使用字面量联合类型
type ColorLiteral = "red" | "green" | "blue";

// 两者都可以提供类型安全
function setColor(color: ColorEnum): void;
function setColor(color: ColorLiteral): void;
```

### 选择建议
```typescript
// 需要反向映射时使用数字枚举
enum Status {
  Pending,
  Approved,
  Rejected
}

// 需要字符串值时使用字符串枚举  
enum LogLevel {
  Error = "ERROR",
  Warn = "WARN"
}

// 简单选项使用字面量联合类型
type Size = "small" | "medium" | "large";
```

## 高级枚举特性

### 枚举成员类型
```typescript
// 每个枚举成员都是独立的类型
enum ShapeKind {
  Circle,
  Square
}

interface Circle {
  kind: ShapeKind.Circle; // 具体成员类型
  radius: number;
}

interface Square {
  kind: ShapeKind.Square; // 具体成员类型
  sideLength: number;
}

function getArea(shape: Circle | Square): number {
  switch (shape.kind) {
    case ShapeKind.Circle:
      return Math.PI * shape.radius ** 2;
    case ShapeKind.Square:
      return shape.sideLength ** 2;
  }
}
```

### 环境枚举
```typescript
// 声明环境枚举（用于扩展已有枚举）
declare enum ExistingEnum {
  A = 1,
  B = 2
}

// 在别的文件中扩展
// 注意：实际扩展需要使用声明合并
```

### 枚举的命名空间
```typescript
// 枚举可以作为命名空间使用
enum MathConstants {
  PI = 3.14159,
  E = 2.71828
}

namespace MathConstants {
  export function area(radius: number): number {
    return PI * radius * radius;
  }
}

console.log(MathConstants.area(5)); // 78.53975
```

## 常见错误

### 1. 忘记枚举是运行时对象
```typescript
// 枚举在运行时是真实对象
enum MyEnum { A, B }

console.log(MyEnum); // { 0: "A", 1: "B", A: 0, B: 1 }

// 如果不需要运行时对象，使用 const enum
const enum ConstEnum { A, B }
// console.log(ConstEnum); // 错误：ConstEnum 不是值
```

### 2. 混淆数字和字符串枚举
```typescript
// 数字枚举有反向映射
enum NumEnum { A = 1 }
console.log(NumEnum[1]); // "A"

// 字符串枚举没有反向映射  
enum StrEnum { A = "A" }
// console.log(StrEnum["A"]); // 错误
```

### 3. 过度使用枚举
```typescript
// 避免：为简单值创建枚举
enum BooleanEnum {
  True = true,
  False = false
}

// 好的实践：直接使用 boolean 类型
let isActive: boolean = true;
```

## 实用技巧

### 1. 枚举迭代
```typescript
// 迭代枚举值
enum Color {
  Red = "red",
  Green = "green",
  Blue = "blue"
}

// 获取所有值
const colorValues = Object.values(Color);
// 获取所有键
const colorKeys = Object.keys(Color);

// 过滤出值（对于数字枚举需要过滤）
const values = Object.values(Color).filter(v => typeof v === "string");
```

### 2. 枚举序列化
```typescript
// 枚举序列化为 JSON
enum UserRole {
  Admin = "admin",
  User = "user"
}

const user = {
  name: "Alice",
  role: UserRole.Admin
};

const json = JSON.stringify(user);
// {"name":"Alice","role":"admin"}

// 从 JSON 解析
const parsed = JSON.parse(json);
if (parsed.role === UserRole.Admin) {
  console.log("Admin user");
}
```

### 3. 枚举验证
```typescript
// 验证字符串是否为有效枚举值
function isValidColor(color: string): color is Color {
  return Object.values(Color).includes(color as Color);
}

const input = "red";
if (isValidColor(input)) {
  // input 是 Color 类型
  console.log(Color[input]);
}
```

## 练习建议

1. 创建各种类型的枚举并体验其特性
2. 练习枚举在状态管理中的应用
3. 比较枚举和字面量联合类型的区别
4. 使用常量枚举优化性能
5. 在实际项目中应用枚举组织常量

---
最后更新: 2025-11-20