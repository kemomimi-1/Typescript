# TypeScript 字面量类型

## 概述
字面量类型（Literal Types）允许将值限制为特定的字面量值，提供更精确的类型控制。字面量类型可以与联合类型结合使用，创建枚举-like 的行为。

## 基本语法

### 字符串字面量类型
```typescript
// 单个字符串字面量
let direction: "left" = "left";
// direction = "right"; // 错误：只能赋值 "left"

// 字符串字面量联合类型
let alignment: "left" | "center" | "right" = "left";
alignment = "center"; // 正确
alignment = "right"; // 正确
// alignment = "top"; // 错误
```

### 数字字面量类型
```typescript
// 单个数字字面量
let answer: 42 = 42;
// answer = 43; // 错误：只能赋值 42

// 数字字面量联合类型
let diceRoll: 1 | 2 | 3 | 4 | 5 | 6 = 1;
diceRoll = 6; // 正确
// diceRoll = 7; // 错误
```

### 布尔字面量类型
```typescript
// 布尔字面量类型
let isTrue: true = true;
// isTrue = false; // 错误：只能赋值 true

let isFalse: false = false;
// isFalse = true; // 错误：只能赋值 false
```

## 字面量类型推断

### const 声明的推断
```typescript
// const 声明推断为字面量类型
const name = "Alice";      // 类型为 "Alice"
const age = 25;            // 类型为 25
const isActive = true;     // 类型为 true

// 但 let 声明推断为基本类型
let mutableName = "Bob";   // 类型为 string
let mutableAge = 30;       // 类型为 number
```

### 对象字面量推断
```typescript
// 对象字面量通常推断为基本类型
const config = {
  theme: "dark",    // string
  fontSize: 14      // number
};

// 使用 as const 获得字面量类型
const preciseConfig = {
  theme: "dark",    // "dark"
  fontSize: 14      // 14
} as const;
```

## 字面量类型的使用

### 函数参数约束
```typescript
// 使用字面量类型约束参数
function setAlignment(align: "left" | "center" | "right") {
  console.log(`Setting alignment to ${align}`);
}

setAlignment("center"); // 正确
// setAlignment("middle"); // 错误
```

### 配置选项
```typescript
// 配置选项使用字面量类型
interface ButtonConfig {
  variant: "primary" | "secondary" | "danger";
  size: "small" | "medium" | "large";
  disabled?: boolean;
}

const button: ButtonConfig = {
  variant: "primary",
  size: "medium"
};
```

### 状态管理
```typescript
// 状态机使用字面量类型
type Status = "idle" | "loading" | "success" | "error";

let currentStatus: Status = "idle";

function transitionTo(status: Status) {
  currentStatus = status;
}

transitionTo("loading"); // 正确
// transitionTo("pending"); // 错误
```

## 模板字面量类型

### 基本模板字面量
```typescript
// 模板字面量类型（TypeScript 4.1+）
type EventName = `on${string}`;

let clickEvent: EventName = "onClick";
let hoverEvent: EventName = "onHover";
// let invalidEvent: EventName = "click"; // 错误
```

### 联合模板字面量
```typescript
// 结合联合类型
type Color = "red" | "green" | "blue";
type ColorEvent = `on${Capitalize<Color>}Change`;

let redEvent: ColorEvent = "onRedChange";
let greenEvent: ColorEvent = "onGreenChange";
// let yellowEvent: ColorEvent = "onYellowChange"; // 错误
```

### 复杂模板模式
```typescript
// 复杂的模板模式
type CSSValue = `${number}px` | `${number}em` | `${number}rem` | `${number}%`;

let width: CSSValue = "100px";
let height: CSSValue = "2rem";
// let margin: CSSValue = "10vw"; // 错误
```

## 字面量类型与联合类型

### 枚举替代方案
```typescript
// 使用字面量联合类型代替枚举
type HttpMethod = "GET" | "POST" | "PUT" | "DELETE" | "PATCH";

function makeRequest(method: HttpMethod, url: string) {
  // 实现
}

makeRequest("POST", "/api/users"); // 正确
// makeRequest("OPTIONS", "/api/users"); // 错误
```

### 智能提示支持
```typescript
// 编辑器会提供智能提示
function createButton(options: {
  variant: "primary" | "secondary";
  size: "small" | "medium" | "large";
}) {
  // 实现
}

// 输入时会自动提示可用的值
createButton({
  variant: "primary", // 输入 "p" 会提示 "primary"
  size: "medium"       // 输入 "m" 会提示 "medium"
});
```

## 常量断言（as const）

### 数组常量断言
```typescript
// 普通数组推断
const colors = ["red", "green", "blue"]; // string[]

// 使用 as const 获得字面量类型
const literalColors = ["red", "green", "blue"] as const;
// 类型为 readonly ["red", "green", "blue"]
```

### 对象常量断言
```typescript
// 普通对象推断
const config = {
  theme: "dark",    // string
  fontSize: 14      // number
};

// 使用 as const 获得字面量类型
const literalConfig = {
  theme: "dark",    // "dark"
  fontSize: 14      // 14
} as const;
```

### 嵌套常量断言
```typescript
// 嵌套对象的常量断言
const appConfig = {
  theme: "dark",
  sizes: {
    small: 12,
    medium: 16,
    large: 20
  },
  colors: ["red", "green", "blue"]
} as const;

// 所有属性都成为字面量类型
```

## 字面量类型工具

### 类型查询
```typescript
// 使用 typeof 获取字面量类型
const COLORS = ["red", "green", "blue"] as const;

type Color = typeof COLORS[number]; // "red" | "green" | "blue"

function getColorName(color: Color): string {
  return color;
}
```

### 映射类型
```typescript
// 使用映射类型操作字面量类型
type ButtonVariants = "primary" | "secondary" | "danger";

type ButtonProps = {
  [K in ButtonVariants]?: boolean;
} & {
  onClick: () => void;
};

const props: ButtonProps = {
  primary: true,
  onClick: () => console.log("clicked")
};
```

## 最佳实践

### 1. 使用字面量类型代替字符串枚举
```typescript
// 好的实践：使用字面量联合类型
type Status = "pending" | "success" | "error";

// 而不是：使用字符串枚举
enum StatusEnum {
  Pending = "pending",
  Success = "success",
  Error = "error"
}
```

### 2. 为配置选项使用字面量类型
```typescript
// 好的实践：配置选项使用字面量类型
interface ModalConfig {
  position: "top" | "center" | "bottom";
  animation: "fade" | "slide" | "none";
  backdrop: boolean;
}

function createModal(config: ModalConfig) {
  // 实现
}
```

### 3. 使用 as const 获得精确类型
```typescript
// 好的实践：使用 as const 获得字面量类型
const DEFAULT_CONFIG = {
  timeout: 5000,
  retries: 3,
  logLevel: "info"
} as const;

// 类型为 { readonly timeout: 5000; readonly retries: 3; readonly logLevel: "info" }
```

### 4. 结合模板字面量类型
```typescript
// 好的实践：使用模板字面量类型创建模式
type CssUnit = "px" | "em" | "rem" | "%";
type CssValue = `${number}${CssUnit}`;

function setStyle(property: string, value: CssValue) {
  // 实现
}

setStyle("width", "100px"); // 正确
// setStyle("width", "100vw"); // 错误
```

## 常见错误

### 1. 混淆 let 和 const 的推断
```typescript
// const 推断为字面量类型
const name = "Alice"; // "Alice"

// let 推断为基本类型  
let mutableName = "Bob"; // string

// 如果需要 let 变量但有字面量类型，需要显式注解
let direction: "left" | "right" = "left";
```

### 2. 忘记使用 as const
```typescript
// 忘记 as const，推断为基本类型
const colors = ["red", "green", "blue"]; // string[]

// 使用 as const 获得字面量类型
const literalColors = ["red", "green", "blue"] as const; // readonly ["red", "green", "blue"]
```

### 3. 过度使用字面量类型
```typescript
// 避免：过度使用字面量类型导致类型系统复杂
let userName: "Alice" = "Alice"; // 过于严格

// 好的实践：在需要精确控制时使用
let alignment: "left" | "center" | "right" = "left"; // 合理使用
```

## 实用技巧

### 1. 提取数组字面量类型
```typescript
const FRUITS = ["apple", "banana", "orange"] as const;

type Fruit = typeof FRUITS[number]; // "apple" | "banana" | "orange"
```

### 2. 创建类型安全的函数重载
```typescript
function handleEvent(event: "click", handler: (e: MouseEvent) => void): void;
function handleEvent(event: "keydown", handler: (e: KeyboardEvent) => void): void;
function handleEvent(event: string, handler: (e: Event) => void): void {
  // 实现
}
```

### 3. 使用 satisfies 操作符
```typescript
// TypeScript 4.9+ 使用 satisfies
type Theme = "light" | "dark";

const config = {
  theme: "dark"
} satisfies { theme: Theme };

// config.theme 是 "dark" 字面量类型
```

## 练习建议

1. 创建各种字面量类型并体验其约束性
2. 练习使用 as const 获得精确类型
3. 创建模板字面量类型并体验模式匹配
4. 比较字面量类型和枚举的区别
5. 在实际项目中应用字面量类型进行配置管理

---
最后更新: 2025-11-20