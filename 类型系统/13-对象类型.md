# TypeScript 对象类型

## 概述
对象是 JavaScript 中最常用的数据结构。TypeScript 提供了多种方式来定义和约束对象类型。

## 基本对象类型

### 内联对象类型
```typescript
let person: { name: string; age: number } = {
  name: "Alice",
  age: 25
};
```

### 可选属性
```typescript
let user: { name: string; email?: string } = {
  name: "Bob"
  // email 是可选的
};
```

### 只读属性
```typescript
let config: { readonly apiKey: string; readonly endpoint: string } = {
  apiKey: "12345",
  endpoint: "/api"
};

// config.apiKey = "new"; // 错误：无法分配到只读属性
```

## 索引签名

### 字符串索引签名
```typescript
interface StringDictionary {
  [key: string]: string;
}

let dict: StringDictionary = {
  name: "Alice",
  email: "alice@example.com"
};
```

### 数字索引签名
```typescript
interface NumberDictionary {
  [index: number]: string;
}

let arr: NumberDictionary = ["a", "b", "c"];
console.log(arr[0]); // "a"
```

### 混合索引签名
```typescript
interface MixedDictionary {
  [key: string]: string | number;
  name: string; // 必须符合索引签名
  age: number;
}
```

## 对象类型操作

### 类型别名
```typescript
type Point = {
  x: number;
  y: number;
};

let point: Point = { x: 10, y: 20 };
```

### 接口
```typescript
interface User {
  id: number;
  name: string;
  email?: string;
}

let user: User = { id: 1, name: "Alice" };
```

## 嵌套对象类型

### 嵌套对象
```typescript
interface Address {
  street: string;
  city: string;
  zipCode: string;
}

interface User {
  name: string;
  address: Address;
}

let user: User = {
  name: "Alice",
  address: {
    street: "123 Main St",
    city: "Anytown",
    zipCode: "12345"
  }
};
```

### 嵌套可选属性
```typescript
interface Profile {
  personal: {
    name: string;
    age?: number;
  };
  preferences?: {
    theme: string;
    language: string;
  };
}
```

## 对象类型扩展

### 交叉类型
```typescript
type Named = { name: string };
type Aged = { age: number };
type Person = Named & Aged;

let person: Person = { name: "Alice", age: 25 };
```

### 接口扩展
```typescript
interface Named {
  name: string;
}

interface Aged {
  age: number;
}

interface Person extends Named, Aged {
  email: string;
}
```

## 对象类型工具

### Partial<T>
```typescript
interface User {
  name: string;
  age: number;
}

let partialUser: Partial<User> = { name: "Alice" };
// 所有属性都是可选的
```

### Readonly<T>
```typescript
interface User {
  name: string;
  age: number;
}

let readOnlyUser: Readonly<User> = { name: "Alice", age: 25 };
// readOnlyUser.name = "Bob"; // 错误：只读
```

### Required<T>
```typescript
interface User {
  name: string;
  age?: number;
}

let requiredUser: Required<User> = { name: "Alice", age: 25 };
// 所有属性都是必需的
```

## 对象类型守卫

### in 操作符
```typescript
interface Circle {
  kind: "circle";
  radius: number;
}

interface Square {
  kind: "square";
  sideLength: number;
}

function getArea(shape: Circle | Square): number {
  if ("radius" in shape) {
    return Math.PI * shape.radius ** 2;
  }
  return shape.sideLength ** 2;
}
```

### 自定义类型守卫
```typescript
function isCircle(shape: any): shape is Circle {
  return shape.kind === "circle" && typeof shape.radius === "number";
}
```

## 对象解构与类型

### 解构带类型注解
```typescript
function processUser({ name, age }: { name: string; age: number }) {
  console.log(name, age);
}
```

### 解构默认值
```typescript
function createUser({
  name,
  age = 18,
  email = ""
}: {
  name: string;
  age?: number;
  email?: string;
}) {
  return { name, age, email };
}
```

## 对象类型兼容性

### 结构类型系统
```typescript
interface Named {
  name: string;
}

let named: Named;
let person = { name: "Alice", age: 25 };
named = person; // 允许，因为 person 有 name 属性
```

### 多余属性检查
```typescript
interface Point {
  x: number;
  y: number;
}

let point: Point = { x: 1, y: 2, z: 3 }; // 错误：多余属性 z
```

## 最佳实践

### 1. 使用接口定义公共API
```typescript
// 好的实践
interface ApiResponse {
  data: any;
  status: number;
  message: string;
}
```

### 2. 使用类型别名组合类型
```typescript
type User = {
  id: number;
  name: string;
} & Timestamped & Identifiable;
```

### 3. 使用索引签名处理动态属性
```typescript
interface Config {
  [key: string]: string | number | boolean;
  name: string; // 必须符合索引签名
}
```

### 4. 使用只读属性保护数据
```typescript
interface AppState {
  readonly user: User | null;
  readonly isLoading: boolean;
}
```

## 常见错误

### 1. 多余属性错误
```typescript
interface Point { x: number; y: number; }
let point: Point = { x: 1, y: 2, z: 3 }; // 错误
```

### 2. 索引签名冲突
```typescript
interface Conflicting {
  [key: string]: string;
  age: number; // 错误：number 不能赋值给 string
}
```

### 3. 混淆接口和类型别名
```typescript
// 接口可以扩展
type A = { x: number };
type B = A & { y: number }; // 使用交叉类型

interface C extends A { y: number; } // 接口扩展
```

## 实用技巧

### 1. 使用 satisfies 操作符
```typescript
const user = {
  name: "Alice",
  age: 25
} satisfies { name: string; age: number };
// 检查类型但不改变推断类型
```

### 2. 模板字面量类型
```typescript
type EventName = `on${Capitalize<string>}`;

interface EventHandlers {
  onClick: () => void;
  onHover: () => void;
  [key: EventName]: () => void;
}
```

### 3. 映射类型
```typescript
type Readonly<T> = {
  readonly [P in keyof T]: T[P];
};

interface User { name: string; age: number; }
type ReadonlyUser = Readonly<User>;
```

## 练习建议

1. 练习定义不同的对象类型
2. 尝试使用接口和类型别名
3. 实践对象类型扩展和组合
4. 使用类型工具操作对象类型
5. 体验对象类型守卫和类型收缩

---
最后更新: 2025-11-20