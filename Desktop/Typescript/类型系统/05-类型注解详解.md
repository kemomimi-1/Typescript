# TypeScript 类型注解详解

## 概述
类型注解是 TypeScript 的核心特性，它允许我们显式地指定变量、函数参数和返回值的类型。

## 什么是类型注解

类型注解使用 `:` 语法在标识符后面指定类型：
```typescript
let variable: Type = value;
```

## 变量类型注解

### 基本类型注解
```typescript
let name: string = "Alice";      // 字符串
let age: number = 25;            // 数字
let isStudent: boolean = true;   // 布尔值
```

### 数组类型注解
```typescript
let numbers: number[] = [1, 2, 3];          // 数字数组
let names: Array<string> = ["A", "B", "C"]; // 泛型语法
```

### 对象类型注解
```typescript
let person: { name: string; age: number } = {
  name: "Bob",
  age: 30
};
```

## 函数类型注解

### 函数参数注解
```typescript
function greet(name: string) {
  console.log(`Hello, ${name}!`);
}
```

### 函数返回值注解
```typescript
function add(a: number, b: number): number {
  return a + b;
}
```

### 箭头函数注解
```typescript
const multiply = (a: number, b: number): number => a * b;
```

## 可选参数和默认值

### 可选参数
```typescript
function createUser(name: string, age?: number) {
  // age 是可选的
}
```

### 默认参数
```typescript
function sayHello(name: string = "Guest") {
  console.log(`Hello, ${name}!`);
}
```

## 类型注解的好处

### 1. 代码可读性
```typescript
// 没有类型注解
function process(data) {
  return data.value * 2;
}

// 有类型注解
function process(data: { value: number }): number {
  return data.value * 2;
}
```

### 2. 早期错误检测
```typescript
let count: number = "hello"; // 编译时错误：不能将类型"string"分配给类型"number"
```

### 3. 更好的编辑器支持
- 代码自动补全
- 参数提示
- 类型信息显示

## 类型注解 vs 类型推断

### 显式注解（推荐）
```typescript
let score: number = 100; // 明确指定类型
```

### 类型推断
```typescript
let score = 100; // TypeScript 推断为 number 类型
```

### 何时使用显式注解
1. 函数参数和返回值
2. 对象字面量
3. 变量初始化为 null 或 undefined
4. 需要明确表达意图时

## 常见注解模式

### 联合类型注解
```typescript
let id: string | number = "123";
id = 456; // 也允许
```

### 字面量类型注解
```typescript
let direction: "north" | "south" = "north";
```

### 元组类型注解
```typescript
let coordinates: [number, number] = [10, 20];
```

## 类型注解的最佳实践

### 1. 保持一致性
在整个项目中保持相同的注解风格。

### 2. 避免过度注解
让 TypeScript 推断简单类型：
```typescript
// 不必要的注解
let count: number = 42;

// 更好的方式
let count = 42;
```

### 3. 为复杂结构添加注解
```typescript
// 复杂的对象结构应该注解
interface User {
  id: number;
  name: string;
  email?: string;
}

let user: User = {
  id: 1,
  name: "Alice"
};
```

### 4. 函数应该总是有返回类型注解
```typescript
// 好的实践
function calculateTotal(price: number, quantity: number): number {
  return price * quantity;
}
```

## 类型注解的局限性

### 1. 运行时类型检查
类型注解只在编译时有效，运行时不会检查类型。

### 2. 第三方库集成
可能需要额外的类型定义文件（@types 包）。

### 3. 动态类型场景
某些高度动态的代码可能难以完全类型化。

## 练习建议

1. 尝试为现有 JavaScript 代码添加类型注解
2. 体验类型错误带来的编译时反馈
3. 比较有注解和无注解代码的编辑器体验差异

## 常见错误

### 1. 忘记注解函数返回值
```typescript
function process() { // 缺少返回类型注解
  return Math.random();
}
```

### 2. 过度使用 any
```typescript
let data: any = getData(); // 尽量避免
```

### 3. 不一致的注解风格
确保团队使用统一的注解约定。

---
最后更新: 2025-11-20